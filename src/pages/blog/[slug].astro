---
import clsx from 'clsx';

import NavV2 from '@src/components/NavV2';
import Post from '@src/components/Post';
import { getAllPosts, getAuthorBySlug } from '@src/domain/content';
import Seo from '@src/components/Seo';
import StructuredData from '@src/components/StructuredData';
import HtmlLayout from '@src/layouts/Html.astro';
import BodyLayout from '@src/layouts/Body.astro';
import HeadLayout from '@src/layouts/Head.astro';
import Footer from '@src/components/Footer';

export async function getStaticPaths() {
  const posts = getAllPosts();
  return posts.map((p) => {
    return { params: { slug: p.slug }, props: { post: p } };
  });
}

const { post } = Astro.props;
const author = getAuthorBySlug(post.author);
---

<HtmlLayout>
  <HeadLayout>
    <Seo
      title={post.title}
      subTitle={post.subTitle}
      tags={post.tags}
      heroImg={post.heroImg}
      canonicalUrl={post.canonicalUrl}
      authorName={author.name}
      ogType="article"
      publishedOn={post.publishedOn}
    />
    <StructuredData
      title={post.title}
      subTitle={post.subTitle}
      tags={post.tags}
      heroImg={post.heroImg}
      authorName={author.name}
      publishedOn={post.publishedOn}
      url={`https://shivekkhurana.com/blog/${post.slug}`}
    />
  </HeadLayout>

  <BodyLayout>
    <NavV2 client:load />
    <article>
      <Post post={post} />
    </article>
    <Footer />
  </BodyLayout>
</HtmlLayout>
